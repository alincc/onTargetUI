<h4 class="padder select-activity" style="display: none">Select Activity</h4>

<h4 class="padder select-task" style="display: none">
    Select Task
    <button class="btn btn-default btn-xs pull-right back-to-activity">Back to select activity</button>
    <button class="btn btn-info btn-xs pull-right m-r-xs add-task">Add Task</button>
</h4>

<h4 class="padder select-task-detail" style="display: none">
    Task Detail
    <button class="btn btn-danger btn-xs pull-right m-r-xs remove-task">Unlink</button>
</h4>

<div class="nav-container select-task-detail">
    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <div>
                <ul class="nav nav-pills nav-justified text-muted">
                    <li class="active" data-tab="task-detail-info">
                        <a href="javascript:void(0)">Info</a>
                    </li>
                    <li data-tab="task-detail-assignee">
                        <a href="javascript:void(0)">Assignee</a>
                    </li>
                    <li data-tab="task-detail-comment">
                        <a href="javascript:void(0)">Comment</a>
                    </li>
                    <li data-tab="task-detail-budget">
                        <a href="javascript:void(0)">Budget</a>
                    </li>
                    <li data-tab="task-detail-progress">
                        <a href="javascript:void(0)">Progress</a>
                    </li>
                    <li data-tab="task-detail-attachment">
                        <a href="javascript:void(0)">Attachments</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</div>

<h4 class="padder select-task-form" style="display: none">
    Add Task
    <button class="btn btn-default btn-xs pull-right back-to-task">
        Back to select task
    </button>
    <button class="btn btn-info btn-xs pull-right m-r-xs submit-add-task" disabled="disabled">
        Save
    </button>
</h4>

<div class="contain-list-container">
    <div class="list-container">
        <div class="activity-list m-t-none" style="display: none">

        </div>

        <div class="task-list" style="display: none">

        </div>

        <div class="task-detail" style="display: none">
            <div class="tab-task task-detail-info">

            </div>
            <div class="tab-task task-detail-assignee" style="display: none">

            </div>
            <div class="tab-task task-detail-comment" style="display: none">
                <div class="task-comment">

                </div>
            </div>
            <div class="tab-task task-detail-budget" style="display: none">
                <div class="budget-task"></div>
            </div>
            <div class="tab-task task-detail-progress" style="display: none">
                <div class="slider"></div>
                <div class="slider-percent"></div>
            </div>
            <div class="tab-task task-detail-attachment" style="display: none">

            </div>
        </div>

        <form id="AddTaskForm" name="task_form" no-validate="" class="form-validation task-form" style="display: none">
            <!-- ngIf: activitySelected && isCreateTask -->
            <div class="create-task">
                <section class="add-task">
                    <div class="form-group">
                        <label>
                            Title
                            <span class="label-required-task">*</span>
                        </label>
                        <input type="text" class="form-control"
                               placeholder="Task Title" name="title">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea type="text" class="form-control"
                                  placeholder="Description of task"
                                  name="description"></textarea>
                    </div>
                    <div class="form-group">
                        <label>
                            Status
                            <span class="label-required-task">*</span>
                        </label>
                        <select class="form-control"
                                name="status">
                            <option value="" class="" selected="selected">-- Select --</option>
                            <option value="1" label="ACTIVE">ACTIVE</option>
                            <option value="2" label="PENDING">PENDING</option>
                            <option value="3" label="COMPLETED">COMPLETED</option>
                            <option value="4" label="EXPIRED">EXPIRED</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>
                            Priority
                            <span class="label-required-task">*</span>
                        </label>
                        <select class="form-control"
                                name="severity">
                            <option value="" selected="selected">-- Select --</option>
                            <option value="1" label="CRITICAL">CRITICAL</option>
                            <option value="2" label="HIGH">HIGH</option>
                            <option value="3" label="LOW">LOW</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>
                            Start date
                            <span class="label-required-task">*</span>
                        </label>

                        <div class="form-group">
                            <div class='input-group date' id="startDate">
                                <input type='text' class="form-control"
                                       placeholder="Start date" name="startDate"/>
                                    <span class="input-group-addon">
                                        <span class="glyphicon glyphicon-calendar"></span>
                                    </span>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>
                            End date
                            <span class="label-required-task">*</span>
                        </label>

                        <div class="form-group">
                            <div class='input-group date' id="endDate">
                                <input type='text' class="form-control"
                                       placeholder="End date" name="endDate"/>
                                    <span class="input-group-addon">
                                        <span class="glyphicon glyphicon-calendar"></span>
                                    </span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>
                            Task Assignee
                        </label>

                        <select class="select2-multiple form-control" id="projectMembers" multiple="multiple"
                                name="taskAssignee"></select>
                    </div><!-- end ngIf: !editTask -->
                </section>
            </div>
            <!-- end ngIf: activitySelected && isCreateTask -->
        </form>
    </div>

    <div class="comment-box item tab-task task-detail-comment" style="display: none">
        <div class="input-group">
            <input type="text" class="form-control comment-text" placeholder="Add a comment or reply here" name="comment" />
                          <span class="input-group-btn">
                            <button class="btn btn-primary comment-button" type="button">Send</button>
                          </span>
        </div>
    </div>
</div>

<div id="TaskAttachmentModal" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <!--<div class="modal-header">-->
                <!--<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>-->
                <!--<h4 class="modal-title">Modal title</h4>-->
            <!--</div>-->
            <div class="modal-body h4 text-center">
                Are you sure you want to delete this task?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="SubmitRemoveAttachment">Delete</button>
                <button type="button" class="btn btn-warning" data-dismiss="modal">Cancel</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<div id="TaskAttachmentViewFileModal" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title"></h4>
            </div>
            <div class="modal-body h4 text-center">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-warning" data-dismiss="modal">Close</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<style>
    .task-detail-progress{
        padding: 10px;
    }

    .slider {
        float: left;
        clear: left;
        width: 100%;
    }

    .slider .ui-slider-range {
        background: #729fcf;
    }

    .slider .ui-slider-handle {
        border-color: #bbb;
        border-radius: 100%;
        box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.3);
        background-color: #ccc;
    }

    .slider-percent{
        text-align: center;
        font-size: 36px;
        font-weight: bold;
    }
</style>

<style>
    .contain-list-container {
        height: 100%;
        padding: 0 0 50px 10px;
    }

    .add-tab-tasks{
        padding-bottom: 104px;
    }

    .add-comment-tasks{
        padding-bottom: 155px;
    }

    .comment-box{
        padding: 10px 10px 0 0;
    }

    .list-container {
        overflow-y: scroll;
        height: 100%;
        padding-right: 10px;
    }

    .padder {
        padding: 5px 20px 5px 20px;
    }

    .select2-container {
        width: 100% !important;
        border-color: #cfdadd !important;
        border-radius: 2px !important;
    }

    .select2-dropdown {
        margin-left: 20px;
    }

    .select2-container--default .select2-selection--multiple .select2-selection__choice{
        background-color: #fff;
        border: 1px solid #dee5e7;
        border-radius: 2px;
        color: #58666e;
    }

    .select2-container--default.select2-container--focus .select2-selection--multiple{
        border: 1px solid #aaa;
    }

    .select-task-detail .navbar-default .container-fluid ul li.active a {
        color: #4984b8 !important;
        background: none;
    }

    .select-task-detail .navbar-default .container-fluid ul li a {
        font-weight: 600;
        padding: 10px 5px;
        font-size: 12px;
    }

    .select-task-detail{
        padding: 0 10px 10px 10px;
    }

    .select-task-detail .navbar-default{
        width: 100%;
        border: 1px solid;
        border-radius: 5px;
        border-color: #dee5e7;
        min-height: auto;
        display: inline-block;
    }

    .select2-container--default .select2-selection--single{
        background-color: #fff;
        border: 1px solid #aaa;
        border-radius: 0;
        border-top-left-radius: 4px;
        border-bottom-left-radius: 4px;
    }

    .select2-container .select2-selection--single{
        height: 34px;
    }

    .select2-container--default .select2-selection--single .select2-selection__rendered{
        line-height: 34px;
    }

    .select2-container--default .select2-selection--single .select2-selection__arrow{
        height: 30px
    }

    .budget-task table td.budget-cost{
        padding: 8px 15px !important;
        min-height: 42px;
    }
</style>

<style>
    .rect-auto,
    .c100.p51 .slice,
    .c100.p52 .slice,
    .c100.p53 .slice,
    .c100.p54 .slice,
    .c100.p55 .slice,
    .c100.p56 .slice,
    .c100.p57 .slice,
    .c100.p58 .slice,
    .c100.p59 .slice,
    .c100.p60 .slice,
    .c100.p61 .slice,
    .c100.p62 .slice,
    .c100.p63 .slice,
    .c100.p64 .slice,
    .c100.p65 .slice,
    .c100.p66 .slice,
    .c100.p67 .slice,
    .c100.p68 .slice,
    .c100.p69 .slice,
    .c100.p70 .slice,
    .c100.p71 .slice,
    .c100.p72 .slice,
    .c100.p73 .slice,
    .c100.p74 .slice,
    .c100.p75 .slice,
    .c100.p76 .slice,
    .c100.p77 .slice,
    .c100.p78 .slice,
    .c100.p79 .slice,
    .c100.p80 .slice,
    .c100.p81 .slice,
    .c100.p82 .slice,
    .c100.p83 .slice,
    .c100.p84 .slice,
    .c100.p85 .slice,
    .c100.p86 .slice,
    .c100.p87 .slice,
    .c100.p88 .slice,
    .c100.p89 .slice,
    .c100.p90 .slice,
    .c100.p91 .slice,
    .c100.p92 .slice,
    .c100.p93 .slice,
    .c100.p94 .slice,
    .c100.p95 .slice,
    .c100.p96 .slice,
    .c100.p97 .slice,
    .c100.p98 .slice,
    .c100.p99 .slice,
    .c100.p100 .slice {
        clip: rect(auto, auto, auto, auto);
    }
    .pie,
    .c100 .bar,
    .c100.p51 .fill,
    .c100.p52 .fill,
    .c100.p53 .fill,
    .c100.p54 .fill,
    .c100.p55 .fill,
    .c100.p56 .fill,
    .c100.p57 .fill,
    .c100.p58 .fill,
    .c100.p59 .fill,
    .c100.p60 .fill,
    .c100.p61 .fill,
    .c100.p62 .fill,
    .c100.p63 .fill,
    .c100.p64 .fill,
    .c100.p65 .fill,
    .c100.p66 .fill,
    .c100.p67 .fill,
    .c100.p68 .fill,
    .c100.p69 .fill,
    .c100.p70 .fill,
    .c100.p71 .fill,
    .c100.p72 .fill,
    .c100.p73 .fill,
    .c100.p74 .fill,
    .c100.p75 .fill,
    .c100.p76 .fill,
    .c100.p77 .fill,
    .c100.p78 .fill,
    .c100.p79 .fill,
    .c100.p80 .fill,
    .c100.p81 .fill,
    .c100.p82 .fill,
    .c100.p83 .fill,
    .c100.p84 .fill,
    .c100.p85 .fill,
    .c100.p86 .fill,
    .c100.p87 .fill,
    .c100.p88 .fill,
    .c100.p89 .fill,
    .c100.p90 .fill,
    .c100.p91 .fill,
    .c100.p92 .fill,
    .c100.p93 .fill,
    .c100.p94 .fill,
    .c100.p95 .fill,
    .c100.p96 .fill,
    .c100.p97 .fill,
    .c100.p98 .fill,
    .c100.p99 .fill,
    .c100.p100 .fill {
        position: absolute;
        border: 0.08em solid #307bbb;
        width: 0.84em;
        height: 0.84em;
        clip: rect(0em, 0.5em, 1em, 0em);
        border-radius: 50%;
        -webkit-transform: rotate(0deg);
        -moz-transform: rotate(0deg);
        -ms-transform: rotate(0deg);
        -o-transform: rotate(0deg);
        transform: rotate(0deg);
    }
    .pie-fill,
    .c100.p51 .bar:after,
    .c100.p51 .fill,
    .c100.p52 .bar:after,
    .c100.p52 .fill,
    .c100.p53 .bar:after,
    .c100.p53 .fill,
    .c100.p54 .bar:after,
    .c100.p54 .fill,
    .c100.p55 .bar:after,
    .c100.p55 .fill,
    .c100.p56 .bar:after,
    .c100.p56 .fill,
    .c100.p57 .bar:after,
    .c100.p57 .fill,
    .c100.p58 .bar:after,
    .c100.p58 .fill,
    .c100.p59 .bar:after,
    .c100.p59 .fill,
    .c100.p60 .bar:after,
    .c100.p60 .fill,
    .c100.p61 .bar:after,
    .c100.p61 .fill,
    .c100.p62 .bar:after,
    .c100.p62 .fill,
    .c100.p63 .bar:after,
    .c100.p63 .fill,
    .c100.p64 .bar:after,
    .c100.p64 .fill,
    .c100.p65 .bar:after,
    .c100.p65 .fill,
    .c100.p66 .bar:after,
    .c100.p66 .fill,
    .c100.p67 .bar:after,
    .c100.p67 .fill,
    .c100.p68 .bar:after,
    .c100.p68 .fill,
    .c100.p69 .bar:after,
    .c100.p69 .fill,
    .c100.p70 .bar:after,
    .c100.p70 .fill,
    .c100.p71 .bar:after,
    .c100.p71 .fill,
    .c100.p72 .bar:after,
    .c100.p72 .fill,
    .c100.p73 .bar:after,
    .c100.p73 .fill,
    .c100.p74 .bar:after,
    .c100.p74 .fill,
    .c100.p75 .bar:after,
    .c100.p75 .fill,
    .c100.p76 .bar:after,
    .c100.p76 .fill,
    .c100.p77 .bar:after,
    .c100.p77 .fill,
    .c100.p78 .bar:after,
    .c100.p78 .fill,
    .c100.p79 .bar:after,
    .c100.p79 .fill,
    .c100.p80 .bar:after,
    .c100.p80 .fill,
    .c100.p81 .bar:after,
    .c100.p81 .fill,
    .c100.p82 .bar:after,
    .c100.p82 .fill,
    .c100.p83 .bar:after,
    .c100.p83 .fill,
    .c100.p84 .bar:after,
    .c100.p84 .fill,
    .c100.p85 .bar:after,
    .c100.p85 .fill,
    .c100.p86 .bar:after,
    .c100.p86 .fill,
    .c100.p87 .bar:after,
    .c100.p87 .fill,
    .c100.p88 .bar:after,
    .c100.p88 .fill,
    .c100.p89 .bar:after,
    .c100.p89 .fill,
    .c100.p90 .bar:after,
    .c100.p90 .fill,
    .c100.p91 .bar:after,
    .c100.p91 .fill,
    .c100.p92 .bar:after,
    .c100.p92 .fill,
    .c100.p93 .bar:after,
    .c100.p93 .fill,
    .c100.p94 .bar:after,
    .c100.p94 .fill,
    .c100.p95 .bar:after,
    .c100.p95 .fill,
    .c100.p96 .bar:after,
    .c100.p96 .fill,
    .c100.p97 .bar:after,
    .c100.p97 .fill,
    .c100.p98 .bar:after,
    .c100.p98 .fill,
    .c100.p99 .bar:after,
    .c100.p99 .fill,
    .c100.p100 .bar:after,
    .c100.p100 .fill {
        -webkit-transform: rotate(180deg);
        -moz-transform: rotate(180deg);
        -ms-transform: rotate(180deg);
        -o-transform: rotate(180deg);
        transform: rotate(180deg);
    }
    .c100 {
        position: relative;
        font-size: 120px;
        width: 1em;
        height: 1em;
        border-radius: 50%;
        float: left;
        margin: 0 0.1em 0.1em 0;
        background-color: #cccccc;
    }
    .c100 *,
    .c100 *:before,
    .c100 *:after {
        -webkit-box-sizing: content-box;
        -moz-box-sizing: content-box;
        box-sizing: content-box;
    }
    .c100.center {
        float: none;
        margin: 0 auto;
    }
    .c100.big {
        font-size: 240px;
    }
    .c100.small {
        font-size: 50px;
    }
    .c100 > span {
        position: absolute;
        width: 100%;
        z-index: 1;
        left: -10px;
        top: -10px;
        width: 5em;
        line-height: 5em;
        font-size: 14px;
        font-weight: bold;
        color: #58666e;
        display: block;
        text-align: center;
        white-space: nowrap;
        -webkit-transition-property: all;
        -moz-transition-property: all;
        -o-transition-property: all;
        transition-property: all;
        -webkit-transition-duration: 0.2s;
        -moz-transition-duration: 0.2s;
        -o-transition-duration: 0.2s;
        transition-duration: 0.2s;
        -webkit-transition-timing-function: ease-out;
        -moz-transition-timing-function: ease-out;
        -o-transition-timing-function: ease-out;
        transition-timing-function: ease-out;
    }
    .c100:after {
        position: absolute;
        top: 0.08em;
        left: 0.08em;
        display: block;
        content: " ";
        border-radius: 50%;
        background-color: #ffffff;
        width: 0.84em;
        height: 0.84em;
        -webkit-transition-property: all;
        -moz-transition-property: all;
        -o-transition-property: all;
        transition-property: all;
        -webkit-transition-duration: 0.2s;
        -moz-transition-duration: 0.2s;
        -o-transition-duration: 0.2s;
        transition-duration: 0.2s;
        -webkit-transition-timing-function: ease-in;
        -moz-transition-timing-function: ease-in;
        -o-transition-timing-function: ease-in;
        transition-timing-function: ease-in;
    }
    .c100 .slice {
        position: absolute;
        width: 1em;
        height: 1em;
        clip: rect(0em, 1em, 1em, 0.5em);
    }
    .c100.p1 .bar {
        -webkit-transform: rotate(3.6deg);
        -moz-transform: rotate(3.6deg);
        -ms-transform: rotate(3.6deg);
        -o-transform: rotate(3.6deg);
        transform: rotate(3.6deg);
    }
    .c100.p2 .bar {
        -webkit-transform: rotate(7.2deg);
        -moz-transform: rotate(7.2deg);
        -ms-transform: rotate(7.2deg);
        -o-transform: rotate(7.2deg);
        transform: rotate(7.2deg);
    }
    .c100.p3 .bar {
        -webkit-transform: rotate(10.8deg);
        -moz-transform: rotate(10.8deg);
        -ms-transform: rotate(10.8deg);
        -o-transform: rotate(10.8deg);
        transform: rotate(10.8deg);
    }
    .c100.p4 .bar {
        -webkit-transform: rotate(14.4deg);
        -moz-transform: rotate(14.4deg);
        -ms-transform: rotate(14.4deg);
        -o-transform: rotate(14.4deg);
        transform: rotate(14.4deg);
    }
    .c100.p5 .bar {
        -webkit-transform: rotate(18deg);
        -moz-transform: rotate(18deg);
        -ms-transform: rotate(18deg);
        -o-transform: rotate(18deg);
        transform: rotate(18deg);
    }
    .c100.p6 .bar {
        -webkit-transform: rotate(21.6deg);
        -moz-transform: rotate(21.6deg);
        -ms-transform: rotate(21.6deg);
        -o-transform: rotate(21.6deg);
        transform: rotate(21.6deg);
    }
    .c100.p7 .bar {
        -webkit-transform: rotate(25.2deg);
        -moz-transform: rotate(25.2deg);
        -ms-transform: rotate(25.2deg);
        -o-transform: rotate(25.2deg);
        transform: rotate(25.2deg);
    }
    .c100.p8 .bar {
        -webkit-transform: rotate(28.8deg);
        -moz-transform: rotate(28.8deg);
        -ms-transform: rotate(28.8deg);
        -o-transform: rotate(28.8deg);
        transform: rotate(28.8deg);
    }
    .c100.p9 .bar {
        -webkit-transform: rotate(32.4deg);
        -moz-transform: rotate(32.4deg);
        -ms-transform: rotate(32.4deg);
        -o-transform: rotate(32.4deg);
        transform: rotate(32.4deg);
    }
    .c100.p10 .bar {
        -webkit-transform: rotate(36deg);
        -moz-transform: rotate(36deg);
        -ms-transform: rotate(36deg);
        -o-transform: rotate(36deg);
        transform: rotate(36deg);
    }
    .c100.p11 .bar {
        -webkit-transform: rotate(39.6deg);
        -moz-transform: rotate(39.6deg);
        -ms-transform: rotate(39.6deg);
        -o-transform: rotate(39.6deg);
        transform: rotate(39.6deg);
    }
    .c100.p12 .bar {
        -webkit-transform: rotate(43.2deg);
        -moz-transform: rotate(43.2deg);
        -ms-transform: rotate(43.2deg);
        -o-transform: rotate(43.2deg);
        transform: rotate(43.2deg);
    }
    .c100.p13 .bar {
        -webkit-transform: rotate(46.800000000000004deg);
        -moz-transform: rotate(46.800000000000004deg);
        -ms-transform: rotate(46.800000000000004deg);
        -o-transform: rotate(46.800000000000004deg);
        transform: rotate(46.800000000000004deg);
    }
    .c100.p14 .bar {
        -webkit-transform: rotate(50.4deg);
        -moz-transform: rotate(50.4deg);
        -ms-transform: rotate(50.4deg);
        -o-transform: rotate(50.4deg);
        transform: rotate(50.4deg);
    }
    .c100.p15 .bar {
        -webkit-transform: rotate(54deg);
        -moz-transform: rotate(54deg);
        -ms-transform: rotate(54deg);
        -o-transform: rotate(54deg);
        transform: rotate(54deg);
    }
    .c100.p16 .bar {
        -webkit-transform: rotate(57.6deg);
        -moz-transform: rotate(57.6deg);
        -ms-transform: rotate(57.6deg);
        -o-transform: rotate(57.6deg);
        transform: rotate(57.6deg);
    }
    .c100.p17 .bar {
        -webkit-transform: rotate(61.2deg);
        -moz-transform: rotate(61.2deg);
        -ms-transform: rotate(61.2deg);
        -o-transform: rotate(61.2deg);
        transform: rotate(61.2deg);
    }
    .c100.p18 .bar {
        -webkit-transform: rotate(64.8deg);
        -moz-transform: rotate(64.8deg);
        -ms-transform: rotate(64.8deg);
        -o-transform: rotate(64.8deg);
        transform: rotate(64.8deg);
    }
    .c100.p19 .bar {
        -webkit-transform: rotate(68.4deg);
        -moz-transform: rotate(68.4deg);
        -ms-transform: rotate(68.4deg);
        -o-transform: rotate(68.4deg);
        transform: rotate(68.4deg);
    }
    .c100.p20 .bar {
        -webkit-transform: rotate(72deg);
        -moz-transform: rotate(72deg);
        -ms-transform: rotate(72deg);
        -o-transform: rotate(72deg);
        transform: rotate(72deg);
    }
    .c100.p21 .bar {
        -webkit-transform: rotate(75.60000000000001deg);
        -moz-transform: rotate(75.60000000000001deg);
        -ms-transform: rotate(75.60000000000001deg);
        -o-transform: rotate(75.60000000000001deg);
        transform: rotate(75.60000000000001deg);
    }
    .c100.p22 .bar {
        -webkit-transform: rotate(79.2deg);
        -moz-transform: rotate(79.2deg);
        -ms-transform: rotate(79.2deg);
        -o-transform: rotate(79.2deg);
        transform: rotate(79.2deg);
    }
    .c100.p23 .bar {
        -webkit-transform: rotate(82.8deg);
        -moz-transform: rotate(82.8deg);
        -ms-transform: rotate(82.8deg);
        -o-transform: rotate(82.8deg);
        transform: rotate(82.8deg);
    }
    .c100.p24 .bar {
        -webkit-transform: rotate(86.4deg);
        -moz-transform: rotate(86.4deg);
        -ms-transform: rotate(86.4deg);
        -o-transform: rotate(86.4deg);
        transform: rotate(86.4deg);
    }
    .c100.p25 .bar {
        -webkit-transform: rotate(90deg);
        -moz-transform: rotate(90deg);
        -ms-transform: rotate(90deg);
        -o-transform: rotate(90deg);
        transform: rotate(90deg);
    }
    .c100.p26 .bar {
        -webkit-transform: rotate(93.60000000000001deg);
        -moz-transform: rotate(93.60000000000001deg);
        -ms-transform: rotate(93.60000000000001deg);
        -o-transform: rotate(93.60000000000001deg);
        transform: rotate(93.60000000000001deg);
    }
    .c100.p27 .bar {
        -webkit-transform: rotate(97.2deg);
        -moz-transform: rotate(97.2deg);
        -ms-transform: rotate(97.2deg);
        -o-transform: rotate(97.2deg);
        transform: rotate(97.2deg);
    }
    .c100.p28 .bar {
        -webkit-transform: rotate(100.8deg);
        -moz-transform: rotate(100.8deg);
        -ms-transform: rotate(100.8deg);
        -o-transform: rotate(100.8deg);
        transform: rotate(100.8deg);
    }
    .c100.p29 .bar {
        -webkit-transform: rotate(104.4deg);
        -moz-transform: rotate(104.4deg);
        -ms-transform: rotate(104.4deg);
        -o-transform: rotate(104.4deg);
        transform: rotate(104.4deg);
    }
    .c100.p30 .bar {
        -webkit-transform: rotate(108deg);
        -moz-transform: rotate(108deg);
        -ms-transform: rotate(108deg);
        -o-transform: rotate(108deg);
        transform: rotate(108deg);
    }
    .c100.p31 .bar {
        -webkit-transform: rotate(111.60000000000001deg);
        -moz-transform: rotate(111.60000000000001deg);
        -ms-transform: rotate(111.60000000000001deg);
        -o-transform: rotate(111.60000000000001deg);
        transform: rotate(111.60000000000001deg);
    }
    .c100.p32 .bar {
        -webkit-transform: rotate(115.2deg);
        -moz-transform: rotate(115.2deg);
        -ms-transform: rotate(115.2deg);
        -o-transform: rotate(115.2deg);
        transform: rotate(115.2deg);
    }
    .c100.p33 .bar {
        -webkit-transform: rotate(118.8deg);
        -moz-transform: rotate(118.8deg);
        -ms-transform: rotate(118.8deg);
        -o-transform: rotate(118.8deg);
        transform: rotate(118.8deg);
    }
    .c100.p34 .bar {
        -webkit-transform: rotate(122.4deg);
        -moz-transform: rotate(122.4deg);
        -ms-transform: rotate(122.4deg);
        -o-transform: rotate(122.4deg);
        transform: rotate(122.4deg);
    }
    .c100.p35 .bar {
        -webkit-transform: rotate(126deg);
        -moz-transform: rotate(126deg);
        -ms-transform: rotate(126deg);
        -o-transform: rotate(126deg);
        transform: rotate(126deg);
    }
    .c100.p36 .bar {
        -webkit-transform: rotate(129.6deg);
        -moz-transform: rotate(129.6deg);
        -ms-transform: rotate(129.6deg);
        -o-transform: rotate(129.6deg);
        transform: rotate(129.6deg);
    }
    .c100.p37 .bar {
        -webkit-transform: rotate(133.20000000000002deg);
        -moz-transform: rotate(133.20000000000002deg);
        -ms-transform: rotate(133.20000000000002deg);
        -o-transform: rotate(133.20000000000002deg);
        transform: rotate(133.20000000000002deg);
    }
    .c100.p38 .bar {
        -webkit-transform: rotate(136.8deg);
        -moz-transform: rotate(136.8deg);
        -ms-transform: rotate(136.8deg);
        -o-transform: rotate(136.8deg);
        transform: rotate(136.8deg);
    }
    .c100.p39 .bar {
        -webkit-transform: rotate(140.4deg);
        -moz-transform: rotate(140.4deg);
        -ms-transform: rotate(140.4deg);
        -o-transform: rotate(140.4deg);
        transform: rotate(140.4deg);
    }
    .c100.p40 .bar {
        -webkit-transform: rotate(144deg);
        -moz-transform: rotate(144deg);
        -ms-transform: rotate(144deg);
        -o-transform: rotate(144deg);
        transform: rotate(144deg);
    }
    .c100.p41 .bar {
        -webkit-transform: rotate(147.6deg);
        -moz-transform: rotate(147.6deg);
        -ms-transform: rotate(147.6deg);
        -o-transform: rotate(147.6deg);
        transform: rotate(147.6deg);
    }
    .c100.p42 .bar {
        -webkit-transform: rotate(151.20000000000002deg);
        -moz-transform: rotate(151.20000000000002deg);
        -ms-transform: rotate(151.20000000000002deg);
        -o-transform: rotate(151.20000000000002deg);
        transform: rotate(151.20000000000002deg);
    }
    .c100.p43 .bar {
        -webkit-transform: rotate(154.8deg);
        -moz-transform: rotate(154.8deg);
        -ms-transform: rotate(154.8deg);
        -o-transform: rotate(154.8deg);
        transform: rotate(154.8deg);
    }
    .c100.p44 .bar {
        -webkit-transform: rotate(158.4deg);
        -moz-transform: rotate(158.4deg);
        -ms-transform: rotate(158.4deg);
        -o-transform: rotate(158.4deg);
        transform: rotate(158.4deg);
    }
    .c100.p45 .bar {
        -webkit-transform: rotate(162deg);
        -moz-transform: rotate(162deg);
        -ms-transform: rotate(162deg);
        -o-transform: rotate(162deg);
        transform: rotate(162deg);
    }
    .c100.p46 .bar {
        -webkit-transform: rotate(165.6deg);
        -moz-transform: rotate(165.6deg);
        -ms-transform: rotate(165.6deg);
        -o-transform: rotate(165.6deg);
        transform: rotate(165.6deg);
    }
    .c100.p47 .bar {
        -webkit-transform: rotate(169.20000000000002deg);
        -moz-transform: rotate(169.20000000000002deg);
        -ms-transform: rotate(169.20000000000002deg);
        -o-transform: rotate(169.20000000000002deg);
        transform: rotate(169.20000000000002deg);
    }
    .c100.p48 .bar {
        -webkit-transform: rotate(172.8deg);
        -moz-transform: rotate(172.8deg);
        -ms-transform: rotate(172.8deg);
        -o-transform: rotate(172.8deg);
        transform: rotate(172.8deg);
    }
    .c100.p49 .bar {
        -webkit-transform: rotate(176.4deg);
        -moz-transform: rotate(176.4deg);
        -ms-transform: rotate(176.4deg);
        -o-transform: rotate(176.4deg);
        transform: rotate(176.4deg);
    }
    .c100.p50 .bar {
        -webkit-transform: rotate(180deg);
        -moz-transform: rotate(180deg);
        -ms-transform: rotate(180deg);
        -o-transform: rotate(180deg);
        transform: rotate(180deg);
    }
    .c100.p51 .bar {
        -webkit-transform: rotate(183.6deg);
        -moz-transform: rotate(183.6deg);
        -ms-transform: rotate(183.6deg);
        -o-transform: rotate(183.6deg);
        transform: rotate(183.6deg);
    }
    .c100.p52 .bar {
        -webkit-transform: rotate(187.20000000000002deg);
        -moz-transform: rotate(187.20000000000002deg);
        -ms-transform: rotate(187.20000000000002deg);
        -o-transform: rotate(187.20000000000002deg);
        transform: rotate(187.20000000000002deg);
    }
    .c100.p53 .bar {
        -webkit-transform: rotate(190.8deg);
        -moz-transform: rotate(190.8deg);
        -ms-transform: rotate(190.8deg);
        -o-transform: rotate(190.8deg);
        transform: rotate(190.8deg);
    }
    .c100.p54 .bar {
        -webkit-transform: rotate(194.4deg);
        -moz-transform: rotate(194.4deg);
        -ms-transform: rotate(194.4deg);
        -o-transform: rotate(194.4deg);
        transform: rotate(194.4deg);
    }
    .c100.p55 .bar {
        -webkit-transform: rotate(198deg);
        -moz-transform: rotate(198deg);
        -ms-transform: rotate(198deg);
        -o-transform: rotate(198deg);
        transform: rotate(198deg);
    }
    .c100.p56 .bar {
        -webkit-transform: rotate(201.6deg);
        -moz-transform: rotate(201.6deg);
        -ms-transform: rotate(201.6deg);
        -o-transform: rotate(201.6deg);
        transform: rotate(201.6deg);
    }
    .c100.p57 .bar {
        -webkit-transform: rotate(205.20000000000002deg);
        -moz-transform: rotate(205.20000000000002deg);
        -ms-transform: rotate(205.20000000000002deg);
        -o-transform: rotate(205.20000000000002deg);
        transform: rotate(205.20000000000002deg);
    }
    .c100.p58 .bar {
        -webkit-transform: rotate(208.8deg);
        -moz-transform: rotate(208.8deg);
        -ms-transform: rotate(208.8deg);
        -o-transform: rotate(208.8deg);
        transform: rotate(208.8deg);
    }
    .c100.p59 .bar {
        -webkit-transform: rotate(212.4deg);
        -moz-transform: rotate(212.4deg);
        -ms-transform: rotate(212.4deg);
        -o-transform: rotate(212.4deg);
        transform: rotate(212.4deg);
    }
    .c100.p60 .bar {
        -webkit-transform: rotate(216deg);
        -moz-transform: rotate(216deg);
        -ms-transform: rotate(216deg);
        -o-transform: rotate(216deg);
        transform: rotate(216deg);
    }
    .c100.p61 .bar {
        -webkit-transform: rotate(219.6deg);
        -moz-transform: rotate(219.6deg);
        -ms-transform: rotate(219.6deg);
        -o-transform: rotate(219.6deg);
        transform: rotate(219.6deg);
    }
    .c100.p62 .bar {
        -webkit-transform: rotate(223.20000000000002deg);
        -moz-transform: rotate(223.20000000000002deg);
        -ms-transform: rotate(223.20000000000002deg);
        -o-transform: rotate(223.20000000000002deg);
        transform: rotate(223.20000000000002deg);
    }
    .c100.p63 .bar {
        -webkit-transform: rotate(226.8deg);
        -moz-transform: rotate(226.8deg);
        -ms-transform: rotate(226.8deg);
        -o-transform: rotate(226.8deg);
        transform: rotate(226.8deg);
    }
    .c100.p64 .bar {
        -webkit-transform: rotate(230.4deg);
        -moz-transform: rotate(230.4deg);
        -ms-transform: rotate(230.4deg);
        -o-transform: rotate(230.4deg);
        transform: rotate(230.4deg);
    }
    .c100.p65 .bar {
        -webkit-transform: rotate(234deg);
        -moz-transform: rotate(234deg);
        -ms-transform: rotate(234deg);
        -o-transform: rotate(234deg);
        transform: rotate(234deg);
    }
    .c100.p66 .bar {
        -webkit-transform: rotate(237.6deg);
        -moz-transform: rotate(237.6deg);
        -ms-transform: rotate(237.6deg);
        -o-transform: rotate(237.6deg);
        transform: rotate(237.6deg);
    }
    .c100.p67 .bar {
        -webkit-transform: rotate(241.20000000000002deg);
        -moz-transform: rotate(241.20000000000002deg);
        -ms-transform: rotate(241.20000000000002deg);
        -o-transform: rotate(241.20000000000002deg);
        transform: rotate(241.20000000000002deg);
    }
    .c100.p68 .bar {
        -webkit-transform: rotate(244.8deg);
        -moz-transform: rotate(244.8deg);
        -ms-transform: rotate(244.8deg);
        -o-transform: rotate(244.8deg);
        transform: rotate(244.8deg);
    }
    .c100.p69 .bar {
        -webkit-transform: rotate(248.4deg);
        -moz-transform: rotate(248.4deg);
        -ms-transform: rotate(248.4deg);
        -o-transform: rotate(248.4deg);
        transform: rotate(248.4deg);
    }
    .c100.p70 .bar {
        -webkit-transform: rotate(252deg);
        -moz-transform: rotate(252deg);
        -ms-transform: rotate(252deg);
        -o-transform: rotate(252deg);
        transform: rotate(252deg);
    }
    .c100.p71 .bar {
        -webkit-transform: rotate(255.6deg);
        -moz-transform: rotate(255.6deg);
        -ms-transform: rotate(255.6deg);
        -o-transform: rotate(255.6deg);
        transform: rotate(255.6deg);
    }
    .c100.p72 .bar {
        -webkit-transform: rotate(259.2deg);
        -moz-transform: rotate(259.2deg);
        -ms-transform: rotate(259.2deg);
        -o-transform: rotate(259.2deg);
        transform: rotate(259.2deg);
    }
    .c100.p73 .bar {
        -webkit-transform: rotate(262.8deg);
        -moz-transform: rotate(262.8deg);
        -ms-transform: rotate(262.8deg);
        -o-transform: rotate(262.8deg);
        transform: rotate(262.8deg);
    }
    .c100.p74 .bar {
        -webkit-transform: rotate(266.40000000000003deg);
        -moz-transform: rotate(266.40000000000003deg);
        -ms-transform: rotate(266.40000000000003deg);
        -o-transform: rotate(266.40000000000003deg);
        transform: rotate(266.40000000000003deg);
    }
    .c100.p75 .bar {
        -webkit-transform: rotate(270deg);
        -moz-transform: rotate(270deg);
        -ms-transform: rotate(270deg);
        -o-transform: rotate(270deg);
        transform: rotate(270deg);
    }
    .c100.p76 .bar {
        -webkit-transform: rotate(273.6deg);
        -moz-transform: rotate(273.6deg);
        -ms-transform: rotate(273.6deg);
        -o-transform: rotate(273.6deg);
        transform: rotate(273.6deg);
    }
    .c100.p77 .bar {
        -webkit-transform: rotate(277.2deg);
        -moz-transform: rotate(277.2deg);
        -ms-transform: rotate(277.2deg);
        -o-transform: rotate(277.2deg);
        transform: rotate(277.2deg);
    }
    .c100.p78 .bar {
        -webkit-transform: rotate(280.8deg);
        -moz-transform: rotate(280.8deg);
        -ms-transform: rotate(280.8deg);
        -o-transform: rotate(280.8deg);
        transform: rotate(280.8deg);
    }
    .c100.p79 .bar {
        -webkit-transform: rotate(284.40000000000003deg);
        -moz-transform: rotate(284.40000000000003deg);
        -ms-transform: rotate(284.40000000000003deg);
        -o-transform: rotate(284.40000000000003deg);
        transform: rotate(284.40000000000003deg);
    }
    .c100.p80 .bar {
        -webkit-transform: rotate(288deg);
        -moz-transform: rotate(288deg);
        -ms-transform: rotate(288deg);
        -o-transform: rotate(288deg);
        transform: rotate(288deg);
    }
    .c100.p81 .bar {
        -webkit-transform: rotate(291.6deg);
        -moz-transform: rotate(291.6deg);
        -ms-transform: rotate(291.6deg);
        -o-transform: rotate(291.6deg);
        transform: rotate(291.6deg);
    }
    .c100.p82 .bar {
        -webkit-transform: rotate(295.2deg);
        -moz-transform: rotate(295.2deg);
        -ms-transform: rotate(295.2deg);
        -o-transform: rotate(295.2deg);
        transform: rotate(295.2deg);
    }
    .c100.p83 .bar {
        -webkit-transform: rotate(298.8deg);
        -moz-transform: rotate(298.8deg);
        -ms-transform: rotate(298.8deg);
        -o-transform: rotate(298.8deg);
        transform: rotate(298.8deg);
    }
    .c100.p84 .bar {
        -webkit-transform: rotate(302.40000000000003deg);
        -moz-transform: rotate(302.40000000000003deg);
        -ms-transform: rotate(302.40000000000003deg);
        -o-transform: rotate(302.40000000000003deg);
        transform: rotate(302.40000000000003deg);
    }
    .c100.p85 .bar {
        -webkit-transform: rotate(306deg);
        -moz-transform: rotate(306deg);
        -ms-transform: rotate(306deg);
        -o-transform: rotate(306deg);
        transform: rotate(306deg);
    }
    .c100.p86 .bar {
        -webkit-transform: rotate(309.6deg);
        -moz-transform: rotate(309.6deg);
        -ms-transform: rotate(309.6deg);
        -o-transform: rotate(309.6deg);
        transform: rotate(309.6deg);
    }
    .c100.p87 .bar {
        -webkit-transform: rotate(313.2deg);
        -moz-transform: rotate(313.2deg);
        -ms-transform: rotate(313.2deg);
        -o-transform: rotate(313.2deg);
        transform: rotate(313.2deg);
    }
    .c100.p88 .bar {
        -webkit-transform: rotate(316.8deg);
        -moz-transform: rotate(316.8deg);
        -ms-transform: rotate(316.8deg);
        -o-transform: rotate(316.8deg);
        transform: rotate(316.8deg);
    }
    .c100.p89 .bar {
        -webkit-transform: rotate(320.40000000000003deg);
        -moz-transform: rotate(320.40000000000003deg);
        -ms-transform: rotate(320.40000000000003deg);
        -o-transform: rotate(320.40000000000003deg);
        transform: rotate(320.40000000000003deg);
    }
    .c100.p90 .bar {
        -webkit-transform: rotate(324deg);
        -moz-transform: rotate(324deg);
        -ms-transform: rotate(324deg);
        -o-transform: rotate(324deg);
        transform: rotate(324deg);
    }
    .c100.p91 .bar {
        -webkit-transform: rotate(327.6deg);
        -moz-transform: rotate(327.6deg);
        -ms-transform: rotate(327.6deg);
        -o-transform: rotate(327.6deg);
        transform: rotate(327.6deg);
    }
    .c100.p92 .bar {
        -webkit-transform: rotate(331.2deg);
        -moz-transform: rotate(331.2deg);
        -ms-transform: rotate(331.2deg);
        -o-transform: rotate(331.2deg);
        transform: rotate(331.2deg);
    }
    .c100.p93 .bar {
        -webkit-transform: rotate(334.8deg);
        -moz-transform: rotate(334.8deg);
        -ms-transform: rotate(334.8deg);
        -o-transform: rotate(334.8deg);
        transform: rotate(334.8deg);
    }
    .c100.p94 .bar {
        -webkit-transform: rotate(338.40000000000003deg);
        -moz-transform: rotate(338.40000000000003deg);
        -ms-transform: rotate(338.40000000000003deg);
        -o-transform: rotate(338.40000000000003deg);
        transform: rotate(338.40000000000003deg);
    }
    .c100.p95 .bar {
        -webkit-transform: rotate(342deg);
        -moz-transform: rotate(342deg);
        -ms-transform: rotate(342deg);
        -o-transform: rotate(342deg);
        transform: rotate(342deg);
    }
    .c100.p96 .bar {
        -webkit-transform: rotate(345.6deg);
        -moz-transform: rotate(345.6deg);
        -ms-transform: rotate(345.6deg);
        -o-transform: rotate(345.6deg);
        transform: rotate(345.6deg);
    }
    .c100.p97 .bar {
        -webkit-transform: rotate(349.2deg);
        -moz-transform: rotate(349.2deg);
        -ms-transform: rotate(349.2deg);
        -o-transform: rotate(349.2deg);
        transform: rotate(349.2deg);
    }
    .c100.p98 .bar {
        -webkit-transform: rotate(352.8deg);
        -moz-transform: rotate(352.8deg);
        -ms-transform: rotate(352.8deg);
        -o-transform: rotate(352.8deg);
        transform: rotate(352.8deg);
    }
    .c100.p99 .bar {
        -webkit-transform: rotate(356.40000000000003deg);
        -moz-transform: rotate(356.40000000000003deg);
        -ms-transform: rotate(356.40000000000003deg);
        -o-transform: rotate(356.40000000000003deg);
        transform: rotate(356.40000000000003deg);
    }
    .c100.p100 .bar {
        -webkit-transform: rotate(360deg);
        -moz-transform: rotate(360deg);
        -ms-transform: rotate(360deg);
        -o-transform: rotate(360deg);
        transform: rotate(360deg);
    }
    .c100:hover {
        cursor: default;
    }
    /*.c100:hover > span {*/
        /*width: 3.33em;*/
        /*line-height: 3.33em;*/
        /*font-size: 0.3em;*/
        /*color: #307bbb;*/
    /*}*/
    /*.c100:hover:after {*/
        /*top: 0.04em;*/
        /*left: 0.04em;*/
        /*width: 0.92em;*/
        /*height: 0.92em;*/
    /*}*/
    .c100.dark {
        background-color: #777777;
    }
    .c100.dark .bar,
    .c100.dark .fill {
        border-color: #c6ff00 !important;
    }
    .c100.dark > span {
        color: #777777;
    }
    .c100.dark:after {
        background-color: #666666;
    }
    /*.c100.dark:hover > span {*/
        /*color: #c6ff00;*/
    /*}*/
    .c100.green .bar,
    .c100.green .fill {
        border-color: #4db53c !important;
    }
    /*.c100.green:hover > span {*/
        /*color: #4db53c;*/
    /*}*/
    .c100.green.dark .bar,
    .c100.green.dark .fill {
        border-color: #5fd400 !important;
    }
    /*.c100.green.dark:hover > span {*/
        /*color: #5fd400;*/
    /*}*/
    .c100.orange .bar,
    .c100.orange .fill {
        border-color: #dd9d22 !important;
    }
    /*.c100.orange:hover > span {*/
        /*color: #dd9d22;*/
    /*}*/
    .c100.orange.dark .bar,
    .c100.orange.dark .fill {
        border-color: #e08833 !important;
    }
    /*.c100.orange.dark:hover > span {*/
        /*color: #e08833;*/
    /*}*/

</style>

<script>
    var xhrLoadActivities;
    var xhrLoadProjectMembers;
    var xhrLoadTaskDetail;

    jQuery(document).ready(function () {
        $('.datetimepicker').datetimepicker();

        $('#startDate').datetimepicker({
            locale: 'en',
            format: 'MM-DD-YYYY',
            widgetPositioning: {
                horizontal: 'left',
                vertical: 'bottom'
            },
            allowInputToggle: true
        });
        $('#endDate').datetimepicker({
            useCurrent: false, //Important! See issue #1075
            locale: 'en',
            format: 'MM-DD-YYYY',
            widgetPositioning: {
                horizontal: 'left',
                vertical: 'bottom'
            },
            allowInputToggle: true
        });
        $("#startDate").on("dp.change", function (e) {
            $('#endDate').data("DateTimePicker").minDate(e.date);
        });
        $("#endDate").on("dp.change", function (e) {
            $('#startDate').data("DateTimePicker").maxDate(e.date);
        });
        console.log($(".slider"));
        $(".slider").slider({
            orientation: "horizontal",
            value: 0,
            range: "min",
            animate: true,
            slide: function(event, ui){
                var percent = ui.value;
                $('.slider-percent').html(percent + '%');
            }
        });
    });

    function Tasks(containerDiv, eId, taskId) {
        var othis = this,
                activities = [],
                tasks = [],
                taskDetail = [],
                taskBudget = {},
                taskAttachments = [],
                domain = $('#request_domain').val(),
                domainNode = $('#request_domain_node').val(),
                projectId = $('#loggedInUserProjectId').val(),
                projectBimFileId = $('#projectBimFileId').val(),
                userId = $('#loggedInUserId').val(),
                currentUserFirstName = $('#currentUserFirstName').val(),
                currentUserLastName = $('#currentUserLastName').val(),
                resourceUrl = $('#resourceUrl').val(),
                scrollContainer = containerDiv.find('.list-container'),
                stringData,
                stringDataTask,
                stringDataTaskDetail,
                stringDataTaskDetailAssignee,
                stringDataTaskDetailComment,
                stringDataTaskDetailBudget,
                stringDataTaskDetailAttachment,
                isLoadedDetail,
                isAssigning,
                currentTaskAttachmentId;

        var request = {
            baseRequest: {
                loggedInUserId: Global.authenticationData.userData.userId,
                loggedInUserProjectId: Global.projectData.project.projectId
            }
        };
        var assigneeSelect = [];
        var dt = $.extend({}, request, {
            projectId: projectId
        });

        this.isScrollAtBottom = false;

        this.scrollDown = function() {
            if(scrollContainer.length) {
                scrollContainer.scrollTop(scrollContainer[0].scrollHeight);
            }
        };

        this.hide = function () {
            containerDiv.hide();
        };

        this.show = function () {
            containerDiv.show();

            othis.abort();

            othis.loadProjectMembers();
            if(!taskId){
                othis.showActivities();
            } else{
                showTaskDetail();
                if(!isLoadedDetail){
                    othis.getTaskById(taskId);
                }
            }
        };

        this.showActivities = function(){
            $('.back-to-activity').click();
            if(!activities.length){
                othis.loadActivities();
            }
        };

        this.loadProjectMembers = function(){
            if(!assigneeSelect.length){
                xhrLoadProjectMembers = $.ajax({
                    url: domain + '/project/getProjectMembers',
                    type: 'POST',
                    data: JSON.stringify(dt),
                    dataType: "json",
                    contentType: 'application/json',
                    async: false
                }).success(function (resp) {
                    if (resp.projectMemberList && resp.projectMemberList.length) {
                        assigneeSelect = resp.projectMemberList;
                    }
                }).error(function (err) {

                });
            }

            var selectBox = [];
            if(taskDetail){
                selectBox = _.filter(assigneeSelect, function(n){
                    return !_.some(taskDetail.assignee, function(n1){
                        return parseInt(n1.userId) === parseInt(n.userId);
                    });
                });
            } else {
                selectBox = assigneeSelect;
            }

            $(".select2-multiple").empty();
            for (var i = 0; i < selectBox.length; i++) {
                $(".select2-multiple").append('<option value="' + selectBox[i].userId + '">' + selectBox[i].contact.firstName + ' ' + selectBox[i].contact.lastName + '</option>');
            }

            $(".select2-multiple").select2();
        };

        this.loadActivities = function () {
            var data = $.extend({}, request, {
                projectId: projectId
            });

            $('.activity-list').empty();
            loading($('.activity-list'));

            xhrLoadActivities = $.ajax({
                url: domain + '/project/getActivityOfProject',
                type: 'POST',
                data: JSON.stringify(data),
                dataType: "json",
                contentType: 'application/json',
            }).success(function (resp) {
                if (resp.projects.length) {
                    activities.splice(0, activities.length);
                    activities.push.apply(activities, resp.projects);

                    $('.activity-list').empty();
                    if(activities.length){
                        for (var i = 0; i < activities.length; i++) {
                            var html = othis.loadContentActivitiesList(activities[i].projectId,
                                    activities[i].projectName,
                                    formatDate(activities[i].startDate),
                                    formatDate(activities[i].endDate),
                                    activities[i].taskCountByStatus,
                                    activities[i].percentageComplete);
                            $('.activity-list').append(html);
                        }
                    } else{
                        notFound($('.activity-list'), 'No activities');
                    }
                }

            }).error(function (err) {

            });
        };

        this.loadTasks = function (activityId) {
            var data = $.extend({}, request, {
                projectId: activityId
            });

            $('.task-list').empty();
            loading($('.task-list'));

            $.ajax({
                url: domain + '/task/getProjectTaskByActivity',
                type: 'POST',
                data: JSON.stringify(data),
                dataType: "json",
                contentType: 'application/json',
            }).success(function (resp) {
                tasks.splice(0, tasks.length);
                tasks.push.apply(tasks, resp.tasks);

                $('.task-list').empty();
                if(tasks.length){
                    for (var i = 0; i < tasks.length; i++) {
                        var html = othis.loadContentTasksList(tasks[i].projectTaskId,
                                tasks[i].percentageComplete,
                                tasks[i].title,
                                tasks[i].assignee,
                                tasks[i].severity.code);
                        $('.task-list').append(html);
                    }
                } else {
                    notFound($('.task-list'), 'No tasks was found');
                }
            }).error(function (err) {

            });
        };

        this.loadContentActivitiesList = function (id,
                                                   projectName,
                                                   startDate,
                                                   endDate,
                                                   taskCountByStatus,
                                                   percentageComplete) {
            if (!stringData) {
                stringData = $.ajax({
                    url: Global.templatePath + "task-list-activities.html",
                    async: false
                }).responseText;
            }

            var result = stringData;
            result = result.replace('{{activity.id}}', id);
            result = result.replace('{{activity.projectName}}', projectName);
            result = result.replace('{{activity.startDate}}', startDate);
            result = result.replace('{{activity.endDate}}', endDate);
            result = result.replace('{{activity.percentageComplete}}', percentageComplete);

            var arrayTaskCountByStatus = [];
            for (var i = 0; i < taskCountByStatus.length; i++) {
                switch (taskCountByStatus[i].statusType) {
                    case 'Active':
                        if (taskCountByStatus[i].taskCount) {
                            arrayTaskCountByStatus.push(taskCountByStatus[i].taskCount + ' Actives');
                        }
                        break;
                    case 'Pending':
                        if (taskCountByStatus[i].taskCount) {
                            arrayTaskCountByStatus.push(taskCountByStatus[i].taskCount + ' Pending');
                        }
                        break;
                    case 'Completed':
                        if (taskCountByStatus[i].taskCount) {
                            arrayTaskCountByStatus.push(taskCountByStatus[i].taskCount + ' Completed');
                        }
                        break;
                    case 'Expired':
                        if (taskCountByStatus[i].taskCount) {
                            arrayTaskCountByStatus.push(taskCountByStatus[i].taskCount + ' Expired');
                        }
                        break;
                }
            }

            result = result.replace('{{taskCount.taskCountByStatus}}', arrayTaskCountByStatus.join(' | '));

            return result;
        };

        this.loadContentTasksList = function (id,
                                              taskPercent,
                                              title,
                                              assignee,
                                              taskPriority) {
            if (!stringDataTask) {
                stringDataTask = $.ajax({
                    url: Global.templatePath + "task-list-tasks.html",
                    async: false
                }).responseText;
            }

            var result = stringDataTask;
            result = result.replace('{{task.id}}', id);
            result = result.replace('{{task.title}}', title);
            result = replaceAll(result, '{{task.priority}}', taskPriority);

            var arrayAssignee = [];
            for (var i = 0; i < assignee.length; i++) {
                arrayAssignee.push(assignee[i].contact.firstName + ' ' + assignee[i].contact.lastName)
            }

            result = replaceAll(result, '{{task.percentageComplete}}', taskPercent);
            switch (parseInt(taskPercent)) {
                case 100:
                    result = result.replace('{{task.percentageColor}}', 'green');
                    break;
                case 0:
                    result = result.replace('{{task.percentageColor}}', '');
                    break;
                default:
                    result = result.replace('{{task.percentageColor}}', 'orange');
                    break;
            }


            result = result.replace('{{task.assignName}}', arrayAssignee.join(', '));

            return result;
        };

        this.assignTask = function (id) {
            taskId = id;

            if(isAssigning){
                return;
            } else{
                isAssigning = true;
            }

            var data = $.extend({}, request, {
                bimFileElementId: eId,
                bimFileId: projectBimFileId,
                taskId: taskId
            });

            $.ajax({
                url: domain + '/bim/link/add',
                type: 'POST',
                data: JSON.stringify(data),
                dataType: "json",
                contentType: 'application/json',
                context: {
                    taskId: taskId
                }
            }).success(function (resp) {
                showTaskDetail();
                othis.getTaskById(this.taskId);

                isAssigning = false;
            }).error(function (err) {

            });
        };

        this.removeAssignTask = function (id) {
            taskId = id;

            var data = $.extend({}, request, {
                bimFileElementId: eId,
                bimFileId: projectBimFileId,
                taskId: taskId
            });

            disabledButton($('.remove-task'));

            $.ajax({
                url: domain + '/bim/link/delete',
                type: 'POST',
                data: JSON.stringify(data),
                dataType: "json",
                contentType: 'application/json',
            }).success(function (resp) {
                taskId = null;

                hideTaskDetail();
                enabledButton($('.remove-task'));
            }).error(function (err) {

            });
        };

        this.addTask = function () {
            var form = $('#AddTaskForm');

            var title = form.find('[name=title]');
            var description = form.find('[name=description]');
            var status = form.find('[name=status]');
            var severity = form.find('[name=severity]');
            var startDate = form.find('[name=startDate]');
            var endDate = form.find('[name=endDate]');
            var taskAssignee = form.find('[name=taskAssignee]');

            var data = $.extend({}, request, {
                userId: Global.authenticationData.userData.userId,
                task: {
                    assignees: _.map(taskAssignee.val(), function (n) {
                        n = parseInt(n);
                        return n;
                    }),
                    description: description.val(),
                    endDate: formatDateRequest(endDate.val()),
                    projectId: Global.projectData.project.projectId,
                    projectTaskId: null,
                    selectedAssignees: _.filter(assigneeSelect, function (n) {
                        return _.some(taskAssignee.val(), function (n1) {
                            return parseInt(n.userId) === parseInt(n1);
                        });
                    }),
                    severity: severity.val(),
                    startDate: formatDateRequest(startDate.val()),
                    status: status.val(),
                    title: title.val()
                }
            });

            disabledButton($('.submit-add-task'));


            $.ajax({
                url: domain + '/task/addTask',
                type: 'POST',
                data: JSON.stringify(data),
                dataType: "json",
                contentType: 'application/json',
            }).success(function (resp) {
                enabledButton($('.submit-add-task'));
                $('.back-to-activity').click();
                othis.assignTask(resp.task.projectTaskId);
            }).error(function (err) {

            });
        };

        this.getTaskById = function (id) {
            var data = $.extend({}, request, {
                taskId: id
            });

            $('.task-detail-info').empty();
            loading($('.task-detail-info'));

            othis.abort();

            xhrLoadTaskDetail = $.ajax({
                url: domain + '/task/getTaskDetail',
                type: 'POST',
                data: JSON.stringify(data),
                dataType: "json",
                contentType: 'application/json',
                context: {
                    taskId: id
                }
            }).success(function (resp) {
                isLoadedDetail = true;
                taskDetail = resp.task;

                $('.task-detail-info').empty();
                $('.task-detail-info').append(othis.loadContentTaskDetail(resp.task.title,
                        resp.task.description,
                        resp.task.status,
                        resp.task.severity.code,
                        resp.task.startDate,
                        resp.task.endDate));

                $('.task-detail-assignee').empty();
                $('.task-detail-assignee').append(othis.loadContentAssigneeTaskDetail(resp.task.assignee));

                $('.task-detail-comment').find('.task-comment').empty();
                $('.task-detail-comment').find('.task-comment').append(othis.loadContentCommentTaskDetail(resp.task.comments));

                $('.slider').slider('value', resp.task.percentageComplete);
                $('.slider-percent').html(resp.task.percentageComplete + '%');

                othis.getTaskBudget(this.taskId);
                othis.getTaskAttachment(this.taskId);


                othis.loadProjectMembers();
                $('.remove-task').attr('data-id', this.taskId);
            }).error(function (err) {

            });
        };

        this.getTaskBudget = function(id){
            var data = $.extend({}, request, {
                taskId: id
            });

            $('.budget-task').empty();
            loading($('.budget-task'));

            $.ajax({
                url: domain + '/task/budget/getTaskBudgetByTaskId',
                type: 'POST',
                data: JSON.stringify(data),
                dataType: "json",
                contentType: 'application/json'
            }).success(function (resp) {
                console.log('global', Global);
                console.log('taskBudget', resp.task);

                taskBudget = resp.task;

                $('.budget-task').empty();
                $('.budget-task').append(othis.loadContentBudgetTaskDetail(resp.task.costsByMonthYear));
            }).error(function (err) {

            });
        };

        this.getTaskAttachment = function(id){
            var data = $.extend({}, request, {
                taskId: id
            });

            $('.task-detail-attachment').empty();
            loading($('.task-detail-attachment'));

            $.ajax({
                url: domain + '/task/getTaskAttachments',
                type: 'POST',
                data: JSON.stringify(data),
                dataType: "json",
                contentType: 'application/json'
            }).success(function (resp) {
                console.log('taskAttachments', resp);

                    taskAttachments = resp.taskAttachments;

                $('.task-detail-attachment').empty();
                $('.task-detail-attachment').append(othis.loadContentAttachmentTaskDetail(resp.taskAttachments));
            }).error(function (err) {

            });
        };

        this.loadContentTaskDetail = function (title, description, status, severity, startDate, endDate) {
            if (!stringDataTaskDetail) {
                stringDataTaskDetail = $.ajax({
                    url: Global.templatePath + "task-detail.html",
                    async: false
                }).responseText;
            }

            var result = stringDataTaskDetail;
            result = result.replace('{{task.title}}', title);
            result = result.replace('{{task.description}}', description);
            result = result.replace('{{task.severity}}', severity);
            result = result.replace('{{task.startDate}}', formatDate(startDate));
            result = result.replace('{{task.endDate}}', formatDate(endDate));

            switch (status) {
                case '1':
                    result = result.replace('{{task.status}}', 'ACTIVES');
                    break;
                case '2':
                    result = result.replace('{{task.status}}', 'PENDING');
                    break;
                case '3':
                    result = result.replace('{{task.status}}', 'COMPLETED');
                    break;
                case '4':
                    result = result.replace('{{task.status}}', 'EXPIRED');
                    break;
            }

            return result;
        };

        this.loadContentAssigneeTaskDetail = function(assignees){
            if (!stringDataTaskDetailAssignee) {
                stringDataTaskDetailAssignee = $.ajax({
                    url: Global.templatePath + "task-detail-assignee.html",
                    async: false
                }).responseText;
            }

            var items = '';
            if(assignees.length){
                for(var i = 0; i < assignees.length; i++){
                    items += '<div class="ow-item">' +
                            '<span><i class="fa fa-user"></i>&nbsp;&nbsp;<span class="name">' + assignees[i].contact.firstName + '&nbsp;' + assignees[i].contact.lastName + '</span></span>' +
                            '<button class="btn btn-xs btn-warning assignee-remove" data-id="' + assignees[i].userId + '">' +
                            '<i class="fa fa-minus"></i> Remove' +
                            '</button>' +
                            '</div>';
                }
            } else{
                items += '<div class="no-result text-muted m-b-xs">This task has not been assigned yet.</div>';
            }

            var result = stringDataTaskDetailAssignee;
            result = result.replace('{{task.assignees}}', items);
            return result;
        };

        this.loadContentCommentTaskDetail = function(comments){
            if (!stringDataTaskDetailComment) {
                stringDataTaskDetailComment = $.ajax({
                    url: Global.templatePath + "task-detail-comment.html",
                    async: false
                }).responseText;
            }

            var items = '';
            if(comments.length){
                for(var i = 0; i < comments.length; i++){
                    items += '<div class="item">' +
                            '<a href="javascript:void(0)" class="pull-left thumb-sm avatar m-r">' +
                            '<img class="img-circle" src="' + resourceUrl + '/' + comments[i].commenterContact.userImagePath + '">' +
                            '</a>' +
                            '<div class="cm-content text-muted">' +
                            '<span class="cm-name">' + comments[i].commenterContact.firstName + '&nbsp;' + comments[i].commenterContact.lastName + '</span>&nbsp;' +
                            '<span>said:</span>' +
                            '<span class="pull-right">' + parseDateByFormat(comments[i].commentedDate) + '</span>' +
                            '<p>' + comments[i].comment + '</p>' +
                            '</div>' +
                            '</div>';
                }
            } else{
                items += '<div class="no-result text-muted m-t-xs m-b-xs text-center">No comments</div>';
            }

            var result = stringDataTaskDetailComment;
            result = result.replace('{{comment.comments}}', items);

            return result;
        };

        this.loadContentBudgetTaskDetail = function(budget){
            if (!stringDataTaskDetailBudget) {
                stringDataTaskDetailBudget = $.ajax({
                    url: Global.templatePath + "task-detail-budget.html",
                    async: false
                }).responseText;
            }

            var items = '';
            if(budget.length){
                for(var i = 0; i < budget.length; i++){
                    if(budget[i].costs.length){
                        items += '<tr>' +
                                '<td class="interval">' +
                                '<span>' + parseMonthToName(budget[i].taskInterval.month) + '</span>-<span>' + budget[i].taskInterval.year + '</span>' +
                                '</td>';

                        if(budget[i].costs[0]){
                            items += '<td class="budget-cost">' +
                                    '<span class="budget-text">' + showDollarOrHour(budget[i].costs[0].cost) + '</span>' +
                                    '<input type="number" max="9999999" min="-9999999" data-val="' + budget[i].costs[0].cost + '" data-id="' + budget[i].costs[0].id + '" data-cost-type="' + budget[i].costs[0].costType + '" data-month="' + budget[i].costs[0].month + '" data-year="' + budget[i].costs[0].year + '" data-from-date="' + budget[i].costs[0].fromDate + '" data-to-date="' + budget[i].costs[0].toDate + '" class="budget-input" value="' + budget[i].costs[0].cost + '" style="display: none">' +
                                    '</td>';
                        } else{
                            items += '<td class="budget-cost">' +
                                    '<span class="budget-text">' + showDollarOrHour(0) + '</span>' +
                                    '<input type="number" max="9999999" min="-9999999" data-val="0" data-id="" data-cost-type="PLANNED" data-month="' + budget[i].taskInterval.month + '" data-year="' + budget[i].taskInterval.year + '" data-from-date="" data-to-date="" class="budget-input" value="0" style="display: none">' +
                                    '</td>';
                        }

                        if(budget[i].costs[1]){
                            items += '<td class="budget-cost">' +
                                    '<span class="budget-text">' + showDollarOrHour(budget[i].costs[1].cost) + '</span>' +
                                    '<input type="number" max="9999999" min="-9999999" data-val="' + budget[i].costs[1].cost + '" data-id="' + budget[i].costs[1].id + '" data-cost-type="' + budget[i].costs[1].costType + '" data-month="' + budget[i].costs[1].month + '" data-year="' + budget[i].costs[1].year + '" data-from-date="' + budget[i].costs[1].fromDate + '" data-to-date="' + budget[i].costs[1].toDate + '" class="budget-input" value="' + budget[i].costs[1].cost + '" style="display: none">' +
                                    '</td>';
                        } else{
                            items += '<td class="budget-cost">' +
                                    '<span class="budget-text">' + showDollarOrHour(0) + '</span>' +
                                    '<input type="number" max="9999999" min="-9999999" data-val="0" data-id="" data-cost-type="ACTUAL" data-month="' + budget[i].taskInterval.month + '" data-year="' + budget[i].taskInterval.year + '" data-from-date="" data-to-date="" class="budget-input" value="0" style="display: none">' +
                                    '</td>';
                        }

                        items += '</tr>';
                    } else {
                        items += '<tr>' +
                                '<td class="interval">' +
                                '<span>' + parseMonthToName(budget[i].taskInterval.month) + '</span>-<span>' + budget[i].taskInterval.year + '</span>' +
                                '</td>' +
                                '<td class="budget-cost">' +
                                '<span class="budget-text">' + showDollarOrHour(0) + '</span>' +
                                '<input type="number" max="9999999" min="-9999999" data-val="0" data-id="" data-cost-type="PLANNED" data-month="' + budget[i].taskInterval.month + '" data-year="' + budget[i].taskInterval.year + '" data-from-date="" data-to-date="" class="budget-input" value="0" style="display: none">' +
                                '</td>' +
                                '<td class="budget-cost">' +
                                '<span class="budget-text">' + showDollarOrHour(0) + '</span>' +
                                '<input type="number" max="9999999" min="-9999999" data-val="0" data-id="" data-cost-type="ACTUAL" data-month="' + budget[i].taskInterval.month + '" data-year="' + budget[i].taskInterval.year + '" data-from-date="" data-to-date="" class="budget-input" value="0" style="display: none">' +
                                '</td>' +
                                '</tr>';
                    }
                }
            } else{
                return '';
            }

            var result = stringDataTaskDetailBudget;
            result = result.replace('{{budget.costs}}', items);

            return result;
        };

        this.loadContentAttachmentTaskDetail = function(attachments){
            if (!stringDataTaskDetailAttachment) {
                stringDataTaskDetailAttachment = $.ajax({
                    url: Global.templatePath + "task-detail-attachment.html",
                    async: false
                }).responseText;
            }

            var items = '';
            if(attachments.length){
                items += '<table class="table table-bordered">' +
                        '<tr>' +
                        '<th>DOCUMENT</th>' +
                        '<th>UPLOADED BY</th>' +
                        '<th>ACTIONS</th>' +
                        '</tr>';

                for(var i = 0; i < attachments.length; i++){
                    items += '<tr>' +
                            '<td valign="middle" class="file-name">' + attachments[i].fileName + '</td>' +
                            '<td valign="middle" class="upload-by">' + attachments[i].contact.firstName + ' ' + attachments[i].contact.lastName + '</td>' +
                            '<td class="nowrap action">' +
                            '<button class="btn btn-xs btn-info m-r-xxs view-attachment" data-id="' + attachments[i].taskFileId + '"><i class="fa fa-eye"></i></button>' +
                            '<button class="btn btn-xs btn-primary m-r-xxs down-attachment" data-location="' + resourceUrl + '/' + attachments[i].location + '"><i class="fa fa-cloud-download"></i></button>' +
                            '<button class="btn btn-xs btn-danger m-r-xxs remove-attachment" data-id="' + attachments[i].taskFileId + '"><i class="fa fa-trash"></i></button>' +
                            '</td>' +
                            '</tr>';
                }

                items += '</table>';
            }

            var result = stringDataTaskDetailAttachment;
            result = result.replace('{{attachment.attachments}}', items);

            return result;
        };

        this.createOrRemoveAssignee = function(e, assigneeId, members){
            var data = $.extend({}, request, {
                projectId: projectId,
                ownerId: assigneeId,
                taskId: taskId,
                members: members
            });

            disabledButton(e);

            $.ajax({
                url: domain + '/task/assignUserToTask',
                type: 'POST',
                data: JSON.stringify(data),
                dataType: "json",
                contentType: 'application/json',
            }).success(function (resp) {
                taskDetail.assignee = _.filter(assigneeSelect, function(n){
                    return _.some(members, function(n1){
                        return n1 === n.userId;
                    });
                });

                $('.task-detail-assignee').empty();
                $('.task-detail-assignee').append(othis.loadContentAssigneeTaskDetail(taskDetail.assignee));

                othis.loadProjectMembers();
                enabledButton(e);
            }).error(function (err) {

            });
        };

        this.addComment = function(e, comment, commentBy, commentDate, taskCommentId, taskId, fisrtName, lastName){
            var data = $.extend({}, request, {
                comment: comment,
                commentedBy: commentBy,
                commentedDate: commentDate,
                taskCommentId: taskCommentId,
                taskId: taskId,
                commenterContact: {
                    firstName: fisrtName,
                    lastName: lastName
                }
            });

            disabledButton(e);
            disabledButton($('.comment-text'));

            $.ajax({
                url: domain + '/task/addComment',
                type: 'POST',
                data: JSON.stringify(data),
                dataType: "json",
                contentType: 'application/json',
                context: {
                    commentDate: commentDate
                }
            }).success(function (resp) {
                resp.taskComment.commentedDate = this.commentDate;
                taskDetail.comments.push(resp.taskComment);

                $('.task-detail-comment').find('.task-comment').empty();
                $('.task-detail-comment').find('.task-comment').append(othis.loadContentCommentTaskDetail(taskDetail.comments));

                othis.loadProjectMembers();
                $('.comment-text').val('');
                enabledButton(e);
                enabledButton($('.comment-text'));

                if(othis.isScrollAtBottom) {
                    othis.scrollDown();
                }
            }).error(function (err) {

            });
        };

        this.updatePercentage = function(percent, percenType, taskId, taskProgressLogId){
            var data = $.extend({}, request, {
                taskProgressList: {
                    percentageComplete: percent,
                    percentageType: percenType,
                    taskId: taskId,
                    taskProgressLogId: taskProgressLogId
                }
            });

            $('.slider').slider('disable');

            $.ajax({
                url: domain + '/task/percentage/add',
                type: 'POST',
                data: JSON.stringify(data),
                dataType: "json",
                contentType: 'application/json'
            }).success(function (resp) {
                $('.slider').slider('enable');
            }).error(function (err) {

            });
        };

        this.updateBudgetCost = function(e, id, cost, costType, fromDate, isDollar, month, taskId, toDate, year, createBy){
            var data = $.extend({}, request, {
                taskBudgetEstimates: [
                    {
                        cost: cost,
                        costType: costType,
                        fromDate: fromDate,
                        isDollar: isDollar,
                        month: month,
                        taskId: taskId,
                        toDate: toDate,
                        year: year,
                        createdBy: createBy,
                        id: id
                    }
                ]
            });

            disabledButton(e);

            $.ajax({
                url: domain + '/task/budget/add',
                type: 'POST',
                data: JSON.stringify(data),
                dataType: "json",
                contentType: 'application/json',
                context: {
                    cost: cost
                }
            }).success(function (resp) {
                $('.list-container').find('.budget-cost').each(function(){
                    $(this).find('.budget-input').hide();
                    $(this).find('.budget-text').show();
                });
                e.attr('data-val', this.cost);
                e.parent().find('.budget-text').html(showDollarOrHour(parseInt(this.cost)));

                enabledButton(e);
            }).error(function (err) {

            });
        };

        this.viewAttachment = function(){

        };

        this.downAttachment = function(){

        };

        this.deleteAttachment = function(e, id){
            var data = $.extend({}, request, {
                taskFileId: id
            });

            disabledButton(e);

            $.ajax({
                url: domain + '/task/deleteTaskAttachment',
                type: 'POST',
                data: JSON.stringify(data),
                dataType: "json",
                contentType: 'application/json',
                context: {
                    taskId: taskId
                },
            }).success(function (resp) {
                othis.getTaskAttachment(this.taskId);

                $('#TaskAttachmentModal').modal('hide');

                enabledButton(e);
            }).error(function (err) {
                enabledButton(e);
            });
        };

        this.addAttachment = function(file, newFileName, rootFolder, projectAssetFolderName, context, crop){
            disabledButton($('.add-attachment'));

            var data = new FormData();

            data.append('uuid', newGuid());
            data.append('fileName', newFileName);
            data.append('folder', rootFolder);
            data.append('projectAssetFolderName', projectAssetFolderName);
            data.append('context', context || '');
            data.append('crop', crop || false);
            data.append('file', file);

            $.ajax({
                url: domainNode + '/node/upload',
                data: data,
                cache: false,
                contentType: false,
                processData: false,
                type: 'POST',
                headers: {
                    'Authorization': false
                },
                context: {
                    taskId: taskId,
                    userId: userId
                },
                success: function(resp){
                    var fileName = resp.url.substring(resp.url.lastIndexOf('/') + 1);
                    var location = resp.url;

                    othis.saveTaskFile(fileName, location, this.taskId, this.userId);
                },
                error: function(){
                    enabledButton($('.add-attachment'));
                }
            });
        };

        this.saveTaskFile = function(fileName, location, taskId, userId){
            var data = $.extend({}, request, {
                fileName: fileName,
                location: location,
                taskId: taskId,
                userId: userId
            });

            $.ajax({
                url: domain + '/task/saveTaskFile',
                type: 'POST',
                data: JSON.stringify(data),
                dataType: "json",
                contentType: 'application/json',
                context: {
                    taskId: taskId
                },
            }).success(function (resp) {
                othis.getTaskAttachment(this.taskId);

                enabledButton($('.add-attachment'));
            }).error(function (err) {
                enabledButton($('.add-attachment'));
            });
        };

        this.abort = function(){
            if(xhrLoadTaskDetail && xhrLoadTaskDetail.readyState !== 4){
                xhrLoadTaskDetail.abort();
            }

            if(xhrLoadActivities && xhrLoadActivities.readystate !== 4){
                xhrLoadActivities.abort();
            }

            if(xhrLoadProjectMembers && xhrLoadProjectMembers.readyState !== 4){
                xhrLoadProjectMembers.abort();
            }
        };

        var replaceAll = function (str, find, replace) {
            return str.replace(new RegExp(find, 'g'), replace);
        };

        var parseMonthToName = function(month){
            var monthNames = [
                "January", "February", "March",
                "April", "May", "June", "July",
                "August", "September", "October",
                "November", "December"
            ];

            return monthNames[month];
        };

        var formatDate = function (d) {
            if (!d) {
                return undefined;
            }

            var date = new Date(d);
            var day = date.getDate();
            var monthIndex = date.getMonth();
            var year = date.getFullYear();

            return parseMonthToName(monthIndex) + ' ' + day + ' ' + year;
        };

        var formatDateRequest = function(date) {
            var d = new Date(date),
                    month = '' + (d.getMonth() + 1),
                    day = '' + d.getDate(),
                    year = d.getFullYear();

            if (month.length < 2) month = '0' + month;
            if (day.length < 2) day = '0' + day;

            return [year, month, day].join('-') + 'T00:00:00';
        }

        function parseDateByFormat(date) {
            var newDate = new Date(date);

            var sMonth = padValue(newDate.getMonth() + 1);
            var sDay = padValue(newDate.getDate());
            var sYear = newDate.getFullYear();
            var sHour = newDate.getHours();
            var sMinute = padValue(newDate.getMinutes());
            var sAMPM = "am";

            var iHourCheck = parseInt(sHour);

            if (iHourCheck > 12) {
                sAMPM = "pm";
                sHour = iHourCheck - 12;
            }
            else if (iHourCheck === 0) {
                sHour = "12";
            }

            sHour = padValue(sHour);

            return sMonth + "/" + sDay + "/" + sYear + " " + sHour + ":" + sMinute + " " + sAMPM;
        }

        function padValue(value) {
            return (value < 10) ? "0" + value : value;
        }

        var loading = function (e) {
            var html = ' <div class="activity-loading text-center" ng-if="true">' +
                    '<spinner text="Loading...">' +
                    '<i class="fa fa-spin fa-spinner"></i> Loading...</spinner>' +
                    '</div>';

            e.append(html);
        };

        var notFound = function (e, content) {
            var html = '<div class="text-center" ng-if="!isLoadingActivity && !activities.length">' +
                    content +
                    '</div>';

            e.append(html);
        };

        var disabledButton = function(e){
            e.attr('disabled', true);
        };

        var enabledButton = function(e){
            e.prop('disabled', false);
        };

        var showTaskDetail = function () {
            $('.activity-list').hide();
            $('.select-activity').hide();
            $('.select-task').hide();
            $('.task-list').hide();
            $('.task-form').hide();
            $('.select-task-form').hide();

            $('.task-detail').show();
            $('.select-task-detail').show();

            $('.contain-list-container').addClass('add-tab-tasks');
        };

        var hideTaskDetail = function () {
            othis.showActivities();
        };

        var validate = function(){
            var form = $('#AddTaskForm');

            var title = form.find('[name=title]');
            var description = form.find('[name=description]');
            var status = form.find('[name=status]');
            var severity = form.find('[name=severity]');
            var startDate = form.find('[name=startDate]');
            var endDate = form.find('[name=endDate]');
            var taskAssignee = form.find('[name=taskAssignee]');

            if(title.val().length && status.val().length && severity.val().length && startDate.val().length && endDate.val().length){
                return true;
            }

            return false;
        };

        var newGuid = function() {
            function guid() {
                function s4() {
                    return Math.floor((1 + Math.random()) * 0x10000)
                            .toString(16)
                            .substring(1);
                }

                return s4() + s4() + '-' + s4() + '-' + s4() + '-' +
                        s4() + '-' + s4() + s4() + s4();
            }

            return guid();
        };

        var getFileExtension = function(filePath) {
            return filePath.substr(filePath.lastIndexOf('.') + 1);
        };

        var showDollarOrHour = function(cost){
            var unit = '$';

            var configuration = _.find(Global.projectData.project.projectConfiguration, function(n){
                return n.configKey === "UNIT_OF_MEASUREMENT";
            });

            if(configuration){
                unit = configuration.configValue !== 'HOUR' ? '$' : (cost > 1 ? 'HOURS' : 'HOUR');
            }

            return unit === '$' ? (unit + '' + cost) : (cost + ' ' + unit) ;
        };

        //destroy all event
        $('.contain-list-container').off('click').off('keyup');
        $('.list-container').off('click').off('change').off('focusout');
        $('.submit-add-task').off('click');
        $('.back-to-activity').off('click');
        $('.add-task').off('click');
        $('.back-to-task').off('click');
        $('.remove-task').off('click');
        $('[name=title], [name=status], [name=severity], [name=startDate], [name=endDate]').off('change');
        $('data-tab').off('click');
        $(".slider").off('slidechange');
        $('#SubmitRemoveAttachment').off('click');

        $('[name=title], [name=status], [name=severity], [name=startDate], [name=endDate]').change(function(){
            if(validate()){
                $('.submit-add-task').prop('disabled', false);
            } else{
                $('.submit-add-task').attr('disabled', true);
            }
        });

        $('#startDate').on('dp.change', function(){
            if(validate()){
                $('.submit-add-task').prop('disabled', false);
            } else{
                $('.submit-add-task').attr('disabled', true);
            }
        });

        $('#endDate').on('dp.change', function(){
            if(validate()){
                $('.submit-add-task').prop('disabled', false);
            } else {
                $('.submit-add-task').attr('disabled', true);
            }
        });

        $('.list-container').on('click', '.activity-item', function () {
            $('.activity-list').hide();
            $('.select-activity').hide();
            $('.select-task').show();
            $('.task-list').show();

            othis.loadTasks($(this).attr('data-id'));
        });

        $('.list-container').on('click', '.task-item', function () {
            othis.assignTask($(this).attr('data-id'));
        });

        $('.submit-add-task').click(function () {
            othis.addTask();
        });

        $('.back-to-activity').click(function () {
            $('.back-to-task').click();

            $('.activity-list').show();
            $('.select-activity').show();
            $('.select-task').hide();
            $('.task-list').hide();
            $('.task-detail').hide();
            $('.select-task-detail').hide();

            $('.contain-list-container').removeClass('add-tab-tasks');
        });

        $('.add-task').click(function () {
            $('.select-task').hide();
            $('.task-list').hide();
            $('.task-form').show();
            $('.select-task-form').show();
        });

        $('.back-to-task').click(function () {
            $('.select-task').show();
            $('.task-list').show();
            $('.task-form').hide();
            $('.select-task-form').hide();
        });

        $('.remove-task').click(function () {
            othis.removeAssignTask($(this).attr('data-id'));
        });

        $('[data-tab]').click(function(){
            var tab = $(this).attr('data-tab');

            $('.tab-task').hide();
            $('[data-tab]').removeClass('active');

            $('.' + tab).show();
            $(this).addClass('active');

            if(tab === 'task-detail-comment'){
                $('.contain-list-container').addClass('add-comment-tasks');
            } else{
                $('.contain-list-container').removeClass('add-comment-tasks');
            }
        });

        $('.list-container').on('click', '.assignee-remove', function(){
            var assigneeId = $(this).attr('data-id');

            var members = _.map(_.filter(taskDetail.assignee, function(n1){
                return parseInt(n1.userId) !== parseInt(assigneeId);
            }), function(n){
               return parseInt(n.userId);
            });

            othis.createOrRemoveAssignee($(this), assigneeId, members);
        });

        $('.list-container').on('click', '.assignee-create', function(){
            var assigneeId = $('.task-detail-assignee').find('[name=taskAssignee]').val();

            var members = [];

            for(var i = 0; i < taskDetail.assignee.length; i++){
                members.push(taskDetail.assignee[i].userId);
            }
            members.push(parseInt(assigneeId));

            othis.createOrRemoveAssignee($(this), assigneeId, members);
        });

        $('.list-container').on('click', '.assignee-add', function(){
            $('.ow-add-box').show();
            $(this).hide();
        });

        $('.list-container').on('click', '.assignee-cancel', function(){
            $('.ow-add-box').hide();
            $('.assignee-add').show();
        });

        $('.contain-list-container').on('click', '.comment-button', function(){
            var comment = $('.comment-text').val();
            var commentDate = new Date();

            if(!comment || !comment.length){
                return;
            }

            othis.addComment($(this), comment, userId, commentDate, 0, taskId, currentUserFirstName, currentUserLastName);
        });

        $('.contain-list-container').on('keyup', '.comment-text', function(e){
            if(e.which !== 13){
                return;
            }

            var comment = $(this).val();
            var commentDate = new Date();

            if(!comment || !comment.length){
                return;
            }

            othis.addComment($(this), comment, userId, commentDate, 0, taskId, currentUserFirstName, currentUserLastName);
        });

        $(".slider").on( "slidechange", function( event, ui ) {
            var percent = ui.value;
            $('.slider-percent').html(percent + '%');

            othis.updatePercentage(percent, 'PERCENTAGE', taskId, '');
        });

        $('.list-container').on('click', '.budget-cost', function(){
            $('.list-container').find('.budget-cost').each(function(){
                $(this).find('.budget-input').hide();
                $(this).find('.budget-text').show();
            });

            $(this).find('.budget-input').show().focus();
            $(this).find('.budget-text').hide();
        });

        $('.list-container').on('focusout', '.budget-input', function(){
            var cost = $(this).val();
            var costType = $(this).attr('data-cost-type');
            var month = $(this).attr('data-month');
            var year = $(this).attr('data-year');
            var fromDate = $(this).attr('data-from-date');
            var toDate = $(this).attr('data-to-date');
            var isDollar = showDollarOrHour(parseInt(cost)).indexOf('$') > -1;
            var id = $(this).attr('data-id');
            var val = $(this).attr('data-val');

            if(!cost || !cost.length){
                return;
            }

            if(val !== cost){
                if(!id || !id.length){
                    fromDate = taskBudget.startDate;
                    toDate = taskBudget.endDate;
                }

                othis.updateBudgetCost($(this), id, cost, costType, fromDate, isDollar, month, taskId, toDate, year, taskBudget.creatorId);
            } else {
                $('.list-container').find('.budget-cost').each(function(){
                    $(this).find('.budget-input').hide();
                    $(this).find('.budget-text').show();
                });
            }

        });

        $('.list-container').on('click', '.add-attachment', function(){
            $(this).parent().find('.add-attachment-file').click();
        });

        $('.list-container').on('change', '.add-attachment-file', function(){
            var file = $(this)[0].files[0];

            othis.addAttachment(file, file.name, 'projects', Global.projectData.project.projectAssetFolderName, 'task');
        });

        $('.list-container').on('click','.view-attachment', function(){
            currentTaskAttachmentId = $(this).attr('data-id');

            var attachment = _.find(taskAttachments, function(n){
                return parseInt(n.taskFileId) === parseInt(currentTaskAttachmentId);
            });

            if(attachment){
                var fileExtension = getFileExtension(attachment.location);
                var filePath = resourceUrl + '/' + attachment.location;
                var isPdf = /(pdf$)/.test(filePath);
                var isImage = /(png|jpg|jpeg|gif)/.test(fileExtension);
                var item = '';

                if(isPdf){
                    item += '<embed width="100%" height="100%" src="' + filePath + '" alt="pdf" pluginspage="http://www.adobe.com/products/acrobat/readstep2.html">';
                } else if(isImage){
                    item += '<img src="' + filePath + '" style="width: 100%" />';
                }

                $('#TaskAttachmentViewFileModal').modal('show');
                $('#TaskAttachmentViewFileModal').find('.modal-body').html(item);
                $('#TaskAttachmentViewFileModal').find('.modal-title').html(attachment.fileName);
            }

        });

        $('.list-container').on('click','.down-attachment', function(){
            var location = $(this).attr('data-location');

            window.location.href = location;
        });

        $('.list-container').on('click', '.remove-attachment', function(){
            currentTaskAttachmentId = $(this).attr('data-id');

            $('#TaskAttachmentModal').modal('show');
        });

        $('#SubmitRemoveAttachment').click(function(){
            othis.deleteAttachment($(this), currentTaskAttachmentId);
        });

        // Check if scroll at bottom
        if(scrollContainer) {
            scrollContainer.on('scroll', function() {
                othis.isScrollAtBottom = scrollContainer.scrollTop() + scrollContainer.innerHeight() >= scrollContainer[0].scrollHeight;
            });
        }
    }
</script>